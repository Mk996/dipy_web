{"parents": [], "prev": null, "next": null, "title": "Gradients and Spheres", "meta": {}, "body": "<div class=\"sphx-glr-download-link-note admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Click <a class=\"reference internal\" href=\"#sphx-glr-download-examples-built-preprocessing-gradients-spheres-py\"><span class=\"std std-ref\">here</span></a>     to download the full example code</p>\n</div>\n<div class=\"sphx-glr-example-title section\" id=\"gradients-and-spheres\">\n<span id=\"sphx-glr-examples-built-preprocessing-gradients-spheres-py\"></span><h1>Gradients and Spheres<a class=\"headerlink\" href=\"#gradients-and-spheres\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p>This example shows how you can create gradient tables and sphere objects using\n<a href=\"#id5\"><span class=\"problematic\" id=\"id6\">DIPY_</span></a>.</p>\n<p>Usually, as we saw in <a class=\"reference internal\" href=\"../../quick_start/#example-quick-start\"><span class=\"std std-ref\">Getting started with DIPY</span></a>, you load your b-values and\nb-vectors from disk and then you can create your own gradient table. But\nthis time let\u2019s say that you are an MR physicist and you want to design a new\ngradient scheme or you are a scientist who wants to simulate many different\ngradient schemes.</p>\n<p>Now let\u2019s assume that you are interested in creating a multi-shell\nacquisition with 2-shells, one at b=1000 <span class=\"math notranslate nohighlight\">\\(s/mm^2\\)</span> and one at b=2500 <span class=\"math notranslate nohighlight\">\\(s/mm^2\\)</span>.\nFor both shells let\u2019s say that we want a specific number of gradients (64) and\nwe want to have the points on the sphere evenly distributed.</p>\n<p>This is possible using the <code class=\"docutils literal notranslate\"><span class=\"pre\">disperse_charges</span></code> which is an implementation of\nelectrostatic repulsion <a class=\"reference internal\" href=\"#jones1999\" id=\"id1\"><span>[Jones1999]</span></a>.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.core.sphere</span> <span class=\"k\">import</span> <span class=\"n\">disperse_charges</span><span class=\"p\">,</span> <span class=\"n\">Sphere</span><span class=\"p\">,</span> <span class=\"n\">HemiSphere</span>\n</pre></div>\n</div>\n<p>We can first create some random points on a <code class=\"docutils literal notranslate\"><span class=\"pre\">HemiSphere</span></code> using spherical\npolar coordinates.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">n_pts</span> <span class=\"o\">=</span> <span class=\"mi\">64</span>\n<span class=\"n\">theta</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">pi</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">rand</span><span class=\"p\">(</span><span class=\"n\">n_pts</span><span class=\"p\">)</span>\n<span class=\"n\">phi</span> <span class=\"o\">=</span> <span class=\"mi\">2</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">pi</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">rand</span><span class=\"p\">(</span><span class=\"n\">n_pts</span><span class=\"p\">)</span>\n<span class=\"n\">hsph_initial</span> <span class=\"o\">=</span> <span class=\"n\">HemiSphere</span><span class=\"p\">(</span><span class=\"n\">theta</span><span class=\"o\">=</span><span class=\"n\">theta</span><span class=\"p\">,</span> <span class=\"n\">phi</span><span class=\"o\">=</span><span class=\"n\">phi</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Next, we call <code class=\"docutils literal notranslate\"><span class=\"pre\">disperse_charges</span></code> which will iteratively move the points so\nthat the electrostatic potential energy is minimized.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">hsph_updated</span><span class=\"p\">,</span> <span class=\"n\">potential</span> <span class=\"o\">=</span> <span class=\"n\">disperse_charges</span><span class=\"p\">(</span><span class=\"n\">hsph_initial</span><span class=\"p\">,</span> <span class=\"mi\">5000</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>In <code class=\"docutils literal notranslate\"><span class=\"pre\">hsph_updated</span></code> we have the updated <code class=\"docutils literal notranslate\"><span class=\"pre\">HemiSphere</span></code> with the points nicely\ndistributed on the hemisphere. Let\u2019s visualize them.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">dipy.viz</span> <span class=\"k\">import</span> <span class=\"n\">window</span><span class=\"p\">,</span> <span class=\"n\">actor</span>\n\n<span class=\"c1\"># Enables/disables interactive visualization</span>\n<span class=\"n\">interactive</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n\n<span class=\"n\">scene</span> <span class=\"o\">=</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">Scene</span><span class=\"p\">()</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">SetBackground</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">point</span><span class=\"p\">(</span><span class=\"n\">hsph_initial</span><span class=\"o\">.</span><span class=\"n\">vertices</span><span class=\"p\">,</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">red</span><span class=\"p\">,</span>\n                      <span class=\"n\">point_radius</span><span class=\"o\">=</span><span class=\"mf\">0.05</span><span class=\"p\">))</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">point</span><span class=\"p\">(</span><span class=\"n\">hsph_updated</span><span class=\"o\">.</span><span class=\"n\">vertices</span><span class=\"p\">,</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">green</span><span class=\"p\">,</span>\n                      <span class=\"n\">point_radius</span><span class=\"o\">=</span><span class=\"mf\">0.05</span><span class=\"p\">))</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;Saving illustration as initial_vs_updated.png&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;initial_vs_updated.png&#39;</span><span class=\"p\">,</span> <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">300</span><span class=\"p\">,</span> <span class=\"mi\">300</span><span class=\"p\">))</span>\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img alt=\"gradients spheres\" class=\"sphx-glr-single-img\" src=\"../../../_images/sphx_glr_gradients_spheres_001.png\" />\n<p class=\"sphx-glr-script-out\">Out:</p>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>Saving illustration as initial_vs_updated.png\n</pre></div>\n</div>\n<div class=\"figure align-center\" id=\"id2\">\n<img alt=\"examples_built/preprocessing/initial_vs_updated.png\" src=\"examples_built/preprocessing/initial_vs_updated.png\" />\n<p class=\"caption\"><span class=\"caption-text\">Illustration of electrostatic repulsion of red points which become\ngreen points.</span><a class=\"headerlink\" href=\"#id2\" title=\"Permalink to this image\">\u00b6</a></p>\n</div>\n<p>We can also create a sphere from the hemisphere and show it in the\nfollowing way.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">sph</span> <span class=\"o\">=</span> <span class=\"n\">Sphere</span><span class=\"p\">(</span><span class=\"n\">xyz</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">vstack</span><span class=\"p\">((</span><span class=\"n\">hsph_updated</span><span class=\"o\">.</span><span class=\"n\">vertices</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"n\">hsph_updated</span><span class=\"o\">.</span><span class=\"n\">vertices</span><span class=\"p\">)))</span>\n\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">clear</span><span class=\"p\">()</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">point</span><span class=\"p\">(</span><span class=\"n\">sph</span><span class=\"o\">.</span><span class=\"n\">vertices</span><span class=\"p\">,</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">green</span><span class=\"p\">,</span> <span class=\"n\">point_radius</span><span class=\"o\">=</span><span class=\"mf\">0.05</span><span class=\"p\">))</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;Saving illustration as full_sphere.png&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;full_sphere.png&#39;</span><span class=\"p\">,</span> <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">300</span><span class=\"p\">,</span> <span class=\"mi\">300</span><span class=\"p\">))</span>\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img alt=\"gradients spheres\" class=\"sphx-glr-single-img\" src=\"../../../_images/sphx_glr_gradients_spheres_002.png\" />\n<p class=\"sphx-glr-script-out\">Out:</p>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>Saving illustration as full_sphere.png\n</pre></div>\n</div>\n<div class=\"figure align-center\" id=\"id3\">\n<img alt=\"examples_built/preprocessing/full_sphere.png\" src=\"examples_built/preprocessing/full_sphere.png\" />\n<p class=\"caption\"><span class=\"caption-text\">Full sphere.</span><a class=\"headerlink\" href=\"#id3\" title=\"Permalink to this image\">\u00b6</a></p>\n</div>\n<p>It is time to create the Gradients. For this purpose we will use the\nfunction <code class=\"docutils literal notranslate\"><span class=\"pre\">gradient_table</span></code> and fill it with the <code class=\"docutils literal notranslate\"><span class=\"pre\">hsph_updated</span></code> vectors\nthat we created above.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">dipy.core.gradients</span> <span class=\"k\">import</span> <span class=\"n\">gradient_table</span>\n\n<span class=\"n\">vertices</span> <span class=\"o\">=</span> <span class=\"n\">hsph_updated</span><span class=\"o\">.</span><span class=\"n\">vertices</span>\n<span class=\"n\">values</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ones</span><span class=\"p\">(</span><span class=\"n\">vertices</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n</pre></div>\n</div>\n<p>We need two stacks of <code class=\"docutils literal notranslate\"><span class=\"pre\">vertices</span></code>, one for every shell, and we need two sets\nof b-values, one at 1000 <span class=\"math notranslate nohighlight\">\\(s/mm^2\\)</span>, and one at 2500 <span class=\"math notranslate nohighlight\">\\(s/mm^2\\)</span>, as we discussed\npreviously.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">bvecs</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">vstack</span><span class=\"p\">((</span><span class=\"n\">vertices</span><span class=\"p\">,</span> <span class=\"n\">vertices</span><span class=\"p\">))</span>\n<span class=\"n\">bvals</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">hstack</span><span class=\"p\">((</span><span class=\"mi\">1000</span> <span class=\"o\">*</span> <span class=\"n\">values</span><span class=\"p\">,</span> <span class=\"mi\">2500</span> <span class=\"o\">*</span> <span class=\"n\">values</span><span class=\"p\">))</span>\n</pre></div>\n</div>\n<p>We can also add some b0s. Let\u2019s add one at the beginning and one at the end.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">bvecs</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">insert</span><span class=\"p\">(</span><span class=\"n\">bvecs</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]),</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]),</span> <span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"n\">bvals</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">insert</span><span class=\"p\">(</span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">bvals</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]),</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">bvals</span><span class=\"p\">)</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">bvecs</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p class=\"sphx-glr-script-out\">Out:</p>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>[   0. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.\n 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.\n 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.\n 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.\n 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.\n 1000. 1000. 1000. 1000. 1000. 2500. 2500. 2500. 2500. 2500. 2500. 2500.\n 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500.\n 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500.\n 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500.\n 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500.\n 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500. 2500.    0.]\n[[ 0.          0.          0.        ]\n [ 0.51033693 -0.61447812  0.6016418 ]\n [-0.17914891  0.94200616  0.28377818]\n [-0.28132     0.76023095  0.58558343]\n [-0.06893916 -0.79510605  0.60253942]\n [ 0.57434595  0.40405028  0.7119481 ]\n [-0.68451328 -0.17843255  0.70682628]\n [ 0.80738632  0.53831642  0.24154245]\n [-0.57547693  0.14717937  0.80446538]\n [ 0.74665691 -0.45991813  0.48060251]\n [ 0.26813731  0.33290478  0.90403362]\n [-0.00852612  0.65014162  0.75976521]\n [-0.64012747  0.42355894  0.64096385]\n [-0.41228899 -0.09520317  0.9060652 ]\n [-0.35099487  0.52243341  0.77708811]\n [-0.87597919 -0.11503153  0.46843165]\n [-0.81569092 -0.57131453  0.09081865]\n [-0.79103945  0.15866206  0.59083241]\n [ 0.18372187  0.04311276  0.98203236]\n [ 0.13732968  0.96847408  0.20784254]\n [-0.94987103  0.30710648  0.05857169]\n [ 0.42032807  0.87498329  0.24026767]\n [ 0.5010206   0.108022    0.85866735]\n [-0.58095401  0.65450357  0.48385691]\n [ 0.41218752 -0.18962309  0.89114787]\n [-0.79275806  0.54149503  0.27985315]\n [-0.31944689 -0.85167979  0.41544582]\n [ 0.82788392 -0.55159664  0.10173184]\n [-0.46354624  0.83866143  0.28595785]\n [-0.66181669  0.74774606  0.05361434]\n [-0.86244256 -0.38453112  0.32913319]\n [ 0.62182112 -0.29203744  0.72667229]\n [-0.98031309 -0.06750873  0.18555005]\n [ 0.10688594 -0.9936951   0.03384447]\n [ 0.31579761  0.79075582  0.52438259]\n [ 0.03058684 -0.94169877  0.33506399]\n [ 0.79475262  0.36214842  0.48704906]\n [ 0.9938639  -0.03214617  0.1058356 ]\n [-0.9069284   0.24715542  0.34116723]\n [ 0.59507377  0.6492993   0.47360071]\n [-0.66274623 -0.47707997  0.57720199]\n [ 0.9156523  -0.29515297  0.27288383]\n [-0.16827189 -0.31141116  0.93525807]\n [ 0.36182755 -0.87268705  0.32786909]\n [ 0.23420726 -0.77106659  0.59211762]\n [-0.03413824  0.38474427  0.92239169]\n [-0.37872032 -0.65754031  0.65131533]\n [ 0.28806127 -0.52487643  0.80095283]\n [ 0.73339361  0.09098736  0.6736877 ]\n [ 0.02243786  0.85786684  0.51338195]\n [-0.1077015   0.01443281  0.99407851]\n [ 0.92963233  0.13982398  0.34092959]\n [-0.30822728  0.24860414  0.91825483]\n [-0.06130921 -0.57895572  0.81305071]\n [ 0.31377662  0.5873548   0.74602853]\n [-0.64332416 -0.67929423  0.35311949]\n [-0.49262046 -0.85682472  0.15223823]\n [-0.21648677 -0.97080414  0.10330922]\n [ 0.84170536 -0.13237037  0.52345982]\n [ 0.64205174  0.76097028  0.09324056]\n [ 0.13133147 -0.29880876  0.94523297]\n [-0.44035914 -0.40088238  0.80335369]\n [ 0.95040747  0.30853857  0.03911002]\n [ 0.40657439 -0.9131515   0.0291823 ]\n [ 0.63190309 -0.71487373  0.29942283]\n [ 0.51033693 -0.61447812  0.6016418 ]\n [-0.17914891  0.94200616  0.28377818]\n [-0.28132     0.76023095  0.58558343]\n [-0.06893916 -0.79510605  0.60253942]\n [ 0.57434595  0.40405028  0.7119481 ]\n [-0.68451328 -0.17843255  0.70682628]\n [ 0.80738632  0.53831642  0.24154245]\n [-0.57547693  0.14717937  0.80446538]\n [ 0.74665691 -0.45991813  0.48060251]\n [ 0.26813731  0.33290478  0.90403362]\n [-0.00852612  0.65014162  0.75976521]\n [-0.64012747  0.42355894  0.64096385]\n [-0.41228899 -0.09520317  0.9060652 ]\n [-0.35099487  0.52243341  0.77708811]\n [-0.87597919 -0.11503153  0.46843165]\n [-0.81569092 -0.57131453  0.09081865]\n [-0.79103945  0.15866206  0.59083241]\n [ 0.18372187  0.04311276  0.98203236]\n [ 0.13732968  0.96847408  0.20784254]\n [-0.94987103  0.30710648  0.05857169]\n [ 0.42032807  0.87498329  0.24026767]\n [ 0.5010206   0.108022    0.85866735]\n [-0.58095401  0.65450357  0.48385691]\n [ 0.41218752 -0.18962309  0.89114787]\n [-0.79275806  0.54149503  0.27985315]\n [-0.31944689 -0.85167979  0.41544582]\n [ 0.82788392 -0.55159664  0.10173184]\n [-0.46354624  0.83866143  0.28595785]\n [-0.66181669  0.74774606  0.05361434]\n [-0.86244256 -0.38453112  0.32913319]\n [ 0.62182112 -0.29203744  0.72667229]\n [-0.98031309 -0.06750873  0.18555005]\n [ 0.10688594 -0.9936951   0.03384447]\n [ 0.31579761  0.79075582  0.52438259]\n [ 0.03058684 -0.94169877  0.33506399]\n [ 0.79475262  0.36214842  0.48704906]\n [ 0.9938639  -0.03214617  0.1058356 ]\n [-0.9069284   0.24715542  0.34116723]\n [ 0.59507377  0.6492993   0.47360071]\n [-0.66274623 -0.47707997  0.57720199]\n [ 0.9156523  -0.29515297  0.27288383]\n [-0.16827189 -0.31141116  0.93525807]\n [ 0.36182755 -0.87268705  0.32786909]\n [ 0.23420726 -0.77106659  0.59211762]\n [-0.03413824  0.38474427  0.92239169]\n [-0.37872032 -0.65754031  0.65131533]\n [ 0.28806127 -0.52487643  0.80095283]\n [ 0.73339361  0.09098736  0.6736877 ]\n [ 0.02243786  0.85786684  0.51338195]\n [-0.1077015   0.01443281  0.99407851]\n [ 0.92963233  0.13982398  0.34092959]\n [-0.30822728  0.24860414  0.91825483]\n [-0.06130921 -0.57895572  0.81305071]\n [ 0.31377662  0.5873548   0.74602853]\n [-0.64332416 -0.67929423  0.35311949]\n [-0.49262046 -0.85682472  0.15223823]\n [-0.21648677 -0.97080414  0.10330922]\n [ 0.84170536 -0.13237037  0.52345982]\n [ 0.64205174  0.76097028  0.09324056]\n [ 0.13133147 -0.29880876  0.94523297]\n [-0.44035914 -0.40088238  0.80335369]\n [ 0.95040747  0.30853857  0.03911002]\n [ 0.40657439 -0.9131515   0.0291823 ]\n [ 0.63190309 -0.71487373  0.29942283]\n [ 0.          0.          0.        ]]\n</pre></div>\n</div>\n<p>Both b-values and b-vectors look correct. Let\u2019s now create the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">GradientTable</span></code>.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">gtab</span> <span class=\"o\">=</span> <span class=\"n\">gradient_table</span><span class=\"p\">(</span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span><span class=\"p\">)</span>\n\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">clear</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>We can also visualize the gradients. Let\u2019s color the first shell blue and\nthe second shell cyan.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">colors_b1000</span> <span class=\"o\">=</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">blue</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ones</span><span class=\"p\">(</span><span class=\"n\">vertices</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">)</span>\n<span class=\"n\">colors_b2500</span> <span class=\"o\">=</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">cyan</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ones</span><span class=\"p\">(</span><span class=\"n\">vertices</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">)</span>\n<span class=\"n\">colors</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">vstack</span><span class=\"p\">((</span><span class=\"n\">colors_b1000</span><span class=\"p\">,</span> <span class=\"n\">colors_b2500</span><span class=\"p\">))</span>\n<span class=\"n\">colors</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">insert</span><span class=\"p\">(</span><span class=\"n\">colors</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]),</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]),</span> <span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"n\">colors</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ascontiguousarray</span><span class=\"p\">(</span><span class=\"n\">colors</span><span class=\"p\">)</span>\n\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">point</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"o\">.</span><span class=\"n\">gradients</span><span class=\"p\">,</span> <span class=\"n\">colors</span><span class=\"p\">,</span> <span class=\"n\">point_radius</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">))</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;Saving illustration as gradients.png&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;gradients.png&#39;</span><span class=\"p\">,</span> <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">300</span><span class=\"p\">,</span> <span class=\"mi\">300</span><span class=\"p\">))</span>\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img alt=\"gradients spheres\" class=\"sphx-glr-single-img\" src=\"../../../_images/sphx_glr_gradients_spheres_003.png\" />\n<p class=\"sphx-glr-script-out\">Out:</p>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>Saving illustration as gradients.png\n</pre></div>\n</div>\n<div class=\"figure align-center\" id=\"id4\">\n<img alt=\"examples_built/preprocessing/gradients.png\" src=\"examples_built/preprocessing/gradients.png\" />\n<p class=\"caption\"><span class=\"caption-text\">Diffusion gradients.</span><a class=\"headerlink\" href=\"#id4\" title=\"Permalink to this image\">\u00b6</a></p>\n</div>\n<div class=\"section\" id=\"references\">\n<h2>References<a class=\"headerlink\" href=\"#references\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<dl class=\"citation\">\n<dt class=\"label\" id=\"jones1999\"><span class=\"brackets\"><a class=\"fn-backref\" href=\"#id1\">Jones1999</a></span></dt>\n<dd><p>Jones, DK. et al. Optimal strategies for measuring diffusion\nin anisotropic systems by magnetic resonance imaging, Magnetic Resonance\nin Medicine, vol 42, no 3, 515-525, 1999.</p>\n</dd>\n</dl>\n<p class=\"sphx-glr-timing\"><strong>Total running time of the script:</strong> ( 0 minutes  3.765 seconds)</p>\n<div class=\"sphx-glr-footer class sphx-glr-footer-example docutils container\" id=\"sphx-glr-download-examples-built-preprocessing-gradients-spheres-py\">\n<div class=\"sphx-glr-download sphx-glr-download-python docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/3428117be330946f133563e11c285b52/gradients_spheres.py\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Python</span> <span class=\"pre\">source</span> <span class=\"pre\">code:</span> <span class=\"pre\">gradients_spheres.py</span></code></a></p>\n</div>\n<div class=\"sphx-glr-download sphx-glr-download-jupyter docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/c23a098f954d7d76ca59fdf495e7e2d1/gradients_spheres.ipynb\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Jupyter</span> <span class=\"pre\">notebook:</span> <span class=\"pre\">gradients_spheres.ipynb</span></code></a></p>\n</div>\n</div>\n<p class=\"sphx-glr-signature\"><a class=\"reference external\" href=\"https://sphinx-gallery.github.io\">Gallery generated by Sphinx-Gallery</a></p>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"]], "sourcename": "examples_built/preprocessing/gradients_spheres.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Gradients and Spheres</a><ul>\n<li><a class=\"reference internal\" href=\"#references\">References</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "examples_built/preprocessing/gradients_spheres", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}